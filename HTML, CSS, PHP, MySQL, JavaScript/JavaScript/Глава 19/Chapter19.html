<!--
    
    Task Template:

    <p></p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">
    <script></script>
    <hr class="short">
    <hr class="wide">
    <hr class="short">

-->

<!doctype html>
<html lang="ru">

<head>
    <title>Глава 19: Решение локальных задач</title>
    <link rel="stylesheet" href="Chapter19.css">
</head>

<body>
    <pre>
    Глава 19.
    19.1, 19.2, 19.3, 19.5

    </pre>

    <p>19.1</p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">
    <script>
        var ident = new Array("январь ", "февраль ", "март ", "апрель ",
            "май ", "июнь ", "июль ", "август ", "сентябрь ", "октябрь ", "ноябрь ", "декабрь ")
        var iday = new Array("воскресенье", "понедельник", "вторник",
            "среда", "четверг", "пятница", "суббота")
        function rasp(elem) {
            // дата начала работы группы
            var d = new Date(elem.begy.value, elem.begm.value, elem.begd.value)
            // дата окончания работы группы
            var w = new Date(elem.endy.value, elem.endm.value, elem.endd.value)
            // дата текущего занятия
            var t = new Date(elem.begy.value, elem.begm.value, elem.begd.value)
            var s = ""
            // выбранный пользователем день работы
            var n = elem.dt.value
            console.log(d.getDay())
            // сформированная дата дня первого занятия
            var k = d.getDate() + Number(n) - Number(d.getDay())
            console.log(d.getDate())
            if (n < d.getDay())
                k += 7
            t.setDate(k)
            var s1 = "<h4 align='center'>Расписание занятий</h4>" +
                "Предмет: <i><b>" + elem.it1.value + " </b></i><br>" +
                "<i>День занятий: <b>" + iday[1 * n] + "</b></i>"
            var sHEADcopy = "<table align='center' border='3' cellpadding='3' cellspacing='5'>" +
                "<tr><th>Число </th><th>Месяц</th><th>Год</th></tr>"
            var sHEAD = "<table align='center' border='3' cellpadding='3' cellspacing='5'>" +
                "<tr><th>Число </th><th>Месяц</th><th>Год</th></tr>"
            var scur
            while (t.getFullYear() <= w.getFullYear()) {
                scur = "<tr align='center'><td>" + t.getDate() + "</td><td>" +
                    ident[t.getMonth()] + "</td><td>" + t.getFullYear() +
                    "</td></tr>"
                if (t.getFullYear() < w.getFullYear()) sHEAD += scur
                else {
                    if (t.getMonth() < w.getMonth()) sHEAD += scur
                    else {
                        if (t.getMonth() == w.getMonth()) {
                            if (t.getDate() < w.getDate()) sHEAD += scur
                            else {
                                if (t.getDate() == w.getDate()) {
                                    sHEAD += scur; break
                                }
                            }
                        }
                    }
                }
                k = t.getDate() + 7
                t.setDate(k)
            }
            if (sHEAD == sHEADcopy)
                alert("Проверьте даты начала и конца занятий")
            else {
                document.all("id1").style.display = "block"
                document.all("id1").innerHTML = sHEAD + "</table>" + s1
            }
        }
    </script>
    <form name="table1">
        <table border="4" align="center" cellpadding="3" cellspacing="5">
            <tr>
                <th>Начало курсов:</th>
                <th>Конец курсов:</th>
            </tr>
            <tr>
                <td>
                    <pre>
                Число: <input type="text" name="begd" size="10" value="1">
                Месяц: <select name="begm" size="1">
                    <option value="0">Январь</option>
                    <option value="1">Февраль</option>
                    <option value="2">Март</option>
                    <option value="3">Апрель</option>
                    <option value="4">Май</option>
                    <option value="5">Июнь</option>
                    <option value="6">Июль</option>
                    <option value="7">Август</option>
                    <option value="8">Сентябрь</option>
                    <option value="9">Октябрь</option>
                    <option value="10">Ноябрь</option>
                    <option value="11">Декабрь</option>
                </select>
                Год: <input type="text" name="begy" size="10" value="2022">
                    </pre>
                </td>
                <td>
                    <pre>
                Число: <input type="text" name="endd" size="10" value="15">
                Месяц: <select name="endm" size="1">
                    <option value="0">Январь</option>
                    <option value="1">Февраль</option>
                    <option value="2">Март</option>
                    <option value="3">Апрель</option>
                    <option value="4">Май</option>
                    <option value="5">Июнь</option>
                    <option value="6">Июль</option>
                    <option value="7">Август</option>
                    <option value="8">Сентябрь</option>
                    <option value="9">Октябрь</option>
                    <option value="10">Ноябрь</option>
                    <option value="11">Декабрь</option>
                </select>
                Год: <input type="text" name="endy" size="10" value="2022">
                    </pre>
                </td>
            </tr>
            <tr>
                <td>Предмет</td>
                <td align="right"><input type="text" name="it1" size="14" value="Информатика"></td>
            </tr>
            <tr>
                <td>День занятий</td>

                <td colspan="2" align="center">
                    <select name="dt" size="1">
                        <option value="0">Воскресение</option>
                        <option value="1" selected>Понедельник</option>
                        <option value="2">Вторник</option>
                        <option value="3">Среда</option>
                        <option value="4">Четверг</option>
                        <option value="5">Пятница</option>
                        <option value="6">Суббота</option>

                    </select>
                </td>
            </tr>
            <tr>
                <td align="left"><br>
                    <input type="button" value="Сформировать" onclick="rasp(table1)"><br>
                </td>
                <td align="right"><input type="reset" value="Отменить"
                        onclick="document.all('id1').style.display='none'"></td>
            </tr>
        </table>
    </form>
    <p id="id1" style="display:none"></p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">

    <p>19.2</p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">
    <script>
        var iday2 = new Array("воскресенье", "понедельник", "вторник",
            "среда", "четверг", "пятница", "суббота")
        function sche(elem) {
            // дата начала работы группы
            var d = new Date(elem.begy.value, elem.begm.value, elem.begd.value)
            // дата окончания работы группы
            var w = new Date(elem.endy.value, elem.endm.value, elem.endd.value)
            // дата текущего занятия
            var t = new Date(elem.begy.value, elem.begm.value, elem.begd.value)
            // выбранный пользователем день работы
            var n = elem.dt.value
            var nn = 1 * elem.numst.value
            console.log(d.getDay())
            // сформированная дата дня первого занятия
            var k = d.getDate() + Number(n) - Number(d.getDay())
            console.log(d.getDate())
            if (n < d.getDay())
                k += 7
            t.setDate(k)
            var s1 = "Ведомость проведения занятий" + "<p>Дисциплина: " +
                elem.it2.value + "</p>" + "<p>Номер группы: " + elem.numgr.value +
                "</p>" + "День занятий: " + iday2[1 * n] + "<br>"
            var sHEADcopy = "<table align='center' border='3' cellpadding='3' cellspacing='5'>" +
                "<tr><th>Номер</th><th>Фамилия</th>"
            var sHEAD = "<table align='center' border='3' cellpadding='3' cellspacing='5'>" +
                "<tr><th>Номер</th><th>Фамилия</th>"
            var scur
            var num = 0
            while (t.getFullYear() <= w.getFullYear()) {
                var mon = t.getMonth() + 1
                var temp = ((mon < 10) ? ".0" : ".") + mon
                scur = "<th>" + t.getDate() + temp + "</th>"
                if (t.getFullYear() < w.getFullYear()) { sHEAD += scur; num += 1 }
                else {
                    if (t.getMonth() < w.getMonth()) { sHEAD += scur; num += 1 }
                    else {
                        if (t.getMonth() == w.getMonth()) {
                            if (t.getDate() < w.getDate()) { sHEAD += scur; num += 1 }
                            else {
                                if (t.getDate() == w.getDate()) {
                                    { sHEAD += scur; num += 1; break }
                                }
                            }
                        }
                    }
                }
                k = t.getDate() + 7
                t.setDate(k)
            }
            if (sHEAD == sHEADcopy)
                alert("Проверьте даты начала и конца занятий")
            else {
                sHEAD += "<th>Отметка о зачёте</th></tr>"
                var sn = ''
                for (var i = 1; i <= nn; i++) {
                    sn = "<tr><td>" + i + "</td>" + "<td> &nbsp </td>"
                    for (var j = 1; j <= num + 1; j++) { sn += "<td> &nbsp </td>" }
                    sn += "</tr>"
                    sHEAD += sn
                }
                sHEAD += "</table>"
                document.all("id2").style.display = "block"
                document.all("id2").innerHTML = s1 + sHEAD +
                    "<p align='center'>Число занятий в семестре " + num + "</p>"
            }
        }
    </script>
    <form name="table2">
        <table border="4" align="center" cellpadding="3" cellspacing="5">
            <tr>
                <th>Начало семестра:</th>
                <th>Конец семестра:</th>
            </tr>
            <tr>
                <td>
                    <pre>
                Число: <input type="text" name="begd" size="10" value="1">
                Месяц: <select name="begm" size="1">
                    <option value="0">Январь</option>
                    <option value="1">Февраль</option>
                    <option value="2">Март</option>
                    <option value="3">Апрель</option>
                    <option value="4">Май</option>
                    <option value="5">Июнь</option>
                    <option value="6">Июль</option>
                    <option value="7">Август</option>
                    <option value="8">Сентябрь</option>
                    <option value="9">Октябрь</option>
                    <option value="10">Ноябрь</option>
                    <option value="11">Декабрь</option>
                </select>
                Год: <input type="text" name="begy" size="10" value="2022">
                    </pre>
                </td>
                <td>
                    <pre>
                Число: <input type="text" name="endd" size="10" value="15">
                Месяц: <select name="endm" size="1">
                    <option value="0">Январь</option>
                    <option value="1">Февраль</option>
                    <option value="2">Март</option>
                    <option value="3">Апрель</option>
                    <option value="4">Май</option>
                    <option value="5">Июнь</option>
                    <option value="6">Июль</option>
                    <option value="7">Август</option>
                    <option value="8">Сентябрь</option>
                    <option value="9">Октябрь</option>
                    <option value="10">Ноябрь</option>
                    <option value="11">Декабрь</option>
                </select>
                Год: <input type="text" name="endy" size="10" value="2022">
                    </pre>
                </td>
            </tr>
            <tr>
                <td>День занятий</td>

                <td colspan="2" align="center">
                    <select name="dt" size="1">
                        <option value="0">Воскресение</option>
                        <option value="1" selected>Понедельник</option>
                        <option value="2">Вторник</option>
                        <option value="3">Среда</option>
                        <option value="4">Четверг</option>
                        <option value="5">Пятница</option>
                        <option value="6">Суббота</option>

                    </select>
                </td>
            </tr>
            <tr>
                <td>Название дисциплины</td>
                <td><input type="text" size="10" name="it2"></td>
            </tr>
            <tr>
                <td>Число студентов</td>
                <td><input type="text" size="10" name="numst"></td>
            </tr>
            <tr>
                <td>Номер группы</td>
                <td><input type="text" size="10" name="numgr"></td>
            </tr>
            <tr>
                <td align="left"><br>
                    <input type="button" value="Сформировать" onclick="sche(table2)"><br>
                </td>
                <td align="right"><input type="reset" value="Отменить"
                        onclick="document.all('id2').style.display='none'"></td>
            </tr>
        </table>
    </form>
    <p id="id2" style="display:none"></p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">

    <p>19.3</p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">
    <script>
        var cToday = "bgcolor='#BBEEFF'"
        var cEmpty = "bgcolor='#00CCFF'"
        var cDay = "bgcolor='#00ccff'"
        var cCap = "bgcolor='#ffa0a0'"
        var cTable = "bgcolor='#d0d0d0'"

        var HDay
        var HMonth
        var HName
        var left

        var congr
        var today = new Date()
        var Mon = today.getMonth() + 1
        var Day = today.getDate()
        var currDay = today.getDate()
        var currMonth = today.getMonth()
        var currYear = today.getFullYear()
        var i
        function WTF(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11) {
            this[0] = m0; this[1] = m1; this[2] = m2; this[3] = m3; this[4] = m4;
            this[5] = m5; this[6] = m6; this[7] = m7; this[8] = m8; this[9] = m9;
            this[10] = m10; this[11] = m11
        }
        var monames = new Array("Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь")
        var danames = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)
        function RDM(ptoday) {
            var vDay = ptoday.getDay()
            vDay -= 1
            if (vDay == -1) vDay = 6
            return vDay
        }
        function GetRekt() {
            var HoMo = new Array(1, 1, 2, 3, 4, 5, 5, 6, 6, 9, 11, 12)
            var HoDa = new Array(7, 13, 23, 8, 1, 1, 9, 1, 12, 1, 7, 31)
            var HoNa = new Array("Рождества", "Старого НГ", "23 Февраля", "8 Марта", "1 Апреля", "1 Мая - Дня Труда", "9 Мая - Дня Победы", "1 Июня - Дня Защиты Детей", "12 Июня - Дня Независимости", "1 Сентября - Дня Знаний", "7 Ноября - Дня Примирения", "НГ")
            var HoNo = new Array("с Р!", "с п<br> СНГ!", "ЗО <br> с п23Ф!", "ж <br> с п8М!", "с 1А <br> - дс!", "с 1М <br> - пвит!", "с 9М <br> - дп!", "с 1И <br> - дзд!", "с 12И <br> - днр!", "с 1С <br> - дз!", "с 7Н <br> - дп!", "снг!")
            for (i = 0; i <= HoMo.length; i++) {
                if (Mon <= HoMo[i]) {
                    if (Mon == HoMo[i]) {
                        if (Day <= HoDa[i]) {
                            HDay = HoDa[i]
                            HMonth = HoMo[i]
                            HName = HoNa[i]
                            congr = HoNo[i]
                            left = HDay - Day
                            break
                        }
                    }
                    else {
                        HDay = HoDa[i]
                        HMonth = HoMo[i]
                        HName = HoNa[i]
                        congr = HoNo[i]
                        var HoDate = new Date(today.getFullYear(), HMonth - 1, HDay)
                        left = Math.round((HoDate.getTime() - today.getTime()) / (24000 * 3600))
                        break
                    }
                }

            }
            document.all("id3").style.display = "block"
            if (!left) {
                document.all("id3").innerHTML = "<h3> Поздр всех " + congr + "</h3>"
            }
            else {
                document.all("id3").innerHTML = "<h3>До " + HName + "<br> осталось дней: " + left + "</h3>"
            }
        }
        function showCalendar(month, year) {
            document.all("id3").innerHTML += monames[month] + " " + year
            fDay = new Date(year, month, 1)
            sDay = RDM(fDay)
            if (((!year % 4) && (year % 100)) || (!year % 400)) danames[1] = 29
            else danames[1] = 28
            var s = "<table " + cTable +
                " callSpacing='1' cellPadding='1' border='1' align='center'>" +
                "<tr " + cCap + "><th>Пн</th><th>Вт</th><th>Ср</th><th>Чт</th><th>Пт</th><th>Сб</th><th>Вск</th></tr>"
                + "<tr align='right'>"
            var column = 0
            for (i = 0; i < sDay; i++) {
                s += "<td " + cEmpty + "> &nbsp </td>"
                column++
            }
            for (i = 1; i <= danames[month]; i++) {
                if ((i == currDay) && (month == currMonth) && (year == currYear)) {
                    s += "<td " + cToday + ">" + i + "</td>"
                }
                else { s += "<td " + cDay + ">" + i + "</td>" }
                column++
                if (column == 7) {
                    s += "</tr><tr align='right'>"
                    column = 0
                }
            }
            s += "</tr></table>"
            document.all("id3").innerHTML += s
        }
    </script>
    <input type="button" value="Показать" onclick="GetRekt();showCalendar(today.getMonth(),today.getFullYear());">
    <input type="button" value="Убрать"
        onclick="document.all('id3').style.display='none';document.all('id3').innerHTML='';">
    <p id="id3" style="display:none;"></p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">

    <p>19.5</p>
    <hr class="short">
    <hr class="wide">
    <hr class="short">
    <script>
        function solvetab() {
            var d = document
            var n = 1 * d.forms['table4'].num4.value
            var k
            if (n % 2 == 0) k = 1 * n / 2
            else k = 1 * (n + 1) / 2
            var out = top.frames['bottom'].document
            out.close()
            out.open()
            out.writeln("<body bgcolor='silver'><center>")
            out.writeln('<table bgcolor="white" cols=' + n + ' rows=' + n + ' border="3">')
            for (i = 0; i < n; i++) {
                out.writeln('<tr>')
                for (j = 0; j < n; j++) {
                    out.writeln("<td>" + Math.round(Number((j + k - i + 3 * n - 1) % n + 1)) + ' ')

                }
                out.writeln("</tr>")
            }

            out.write('</table>')
            out.writeln("</center><body>")
        }
    </script>
    <form name="table4">
        Введите N: <input name="num4" type="text" size="4"><br>
        <input type="button" value="OK" onclick="solvetab()">
    </form>
    <iframe style="width:400px;height:300px" name="bottom"></frame>
        <hr class="short">
        <hr class="wide">
        <hr class="short">
</body>

</html>